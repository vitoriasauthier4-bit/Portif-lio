(self.modernJsonp=self.modernJsonp||[]).push([["55759"],{523226:function(e,t,n){n.r(t),n.d(t,{default:()=>D});var i=n(281098),o=n(667294),a=n(825332),r=n(20256),s=n(414772),l=n(693875),d=n(502447),c=n(934645),p=n(878709),u=n(346955),h=n(355940),m=n(821342),g=n(595935),x=n(15667),y=n(378888),v=n(448505),f=n(7872),C=n(611499),j=n(601686),b=n(790427),w=n(25837),P=n(310916),S=n(78762),_=n(785893);let k=(0,S.Z)(()=>Promise.all([n.e("96988"),n.e("95853"),n.e("64701")]).then(n.bind(n,358276)),void 0,e=>358276,"SaveAffordance",e=>["96988","95853","64701"]),I=(0,S.Z)(()=>n.e("73301").then(n.bind(n,115649)),void 0,e=>115649,"PostDownloadUpsellPopover",e=>["73301"]),B=(0,S.Z)(()=>Promise.resolve().then(n.bind(n,11919)),void 0,e=>11919,"SecondarySendButtonCommon",e=>[]),T=(0,S.Z)(()=>Promise.all([n.e("25418"),n.e("96415")]).then(n.bind(n,377733)),void 0,e=>377733,"ReactionPickerContainer",e=>["25418","96415"]),Z=(0,S.Z)(()=>n.e("8419").then(n.bind(n,20262)),void 0,e=>20262,"CloseupCommentButton",e=>["8419"]),A=(0,o.memo)(function({goBack:e,gridDescription:t,isDeletedStoryPin:n,inCommentsImprovedDropdownExp:i,inCommentsPopoverExp:S,isEligibleForAggregatedComments:A,isEligibleForPinReactions:D,isOnSecretBoard:E,onEditSubmit:R,pin:M,viewParameter:L,viewType:z,onSaveButtonClick:O,showRepinOnInitialRender:U,isStoryPin:W,actionBarContainerRef:F,outerPaddingSize:G=C.g9,maxWidth:Y,showLeadPin:H,scrollContainerRef:K}){let J=(0,a.TH)(),N=(0,v.Z)(),{showEnabledSaveBehavior:$}=(0,P.Yh)(!0),{imgSrc:q}=(0,p.G)(),{clientTrackingParams:X,showCloseupContentRight:Q,closeupWithinMasonryEnabled:V,peekCloseupEnabled:ee}=(0,j.x4)(),{viewType:et,viewParameter:en}=(0,u.SU)(),ei=(0,m.Z)(),eo=(0,f.q6)(ei,M?.pinner?.id,N),ea=(0,c.Z)({showProductDetailPage:!!M.is_eligible_for_pdp}),[er,es]=(0,o.useState)(!!(0,y.mB)(J.search).share),[el,ed]=(0,o.useState)(!1),{shareFromPostDownloadUpsell:ec,setShareFromPostDownloadUpsell:ep,saveToBoardFromPostDownloadUpsell:eu,setSaveToBoardFromPostDownloadUpsell:eh}=(0,s.tS)();(0,o.useEffect)(()=>{ec&&(es(!0),ep(!1))},[ec,ep]);let em=(0,o.useCallback)(e=>ed(e),[]),eg=(0,o.useCallback)(()=>es(!1),[]),ex=(0,o.useCallback)(()=>es(e=>!e),[]),ey=M.board?.owner?.id||M.pinner?.id,{aggregated_pin_data:ev,comments_disabled:ef,reaction_counts:eC}=M,{isRTL:ej}=(0,x.B)(),eb=V?Y:Y||C.Gg,ew=(0,d.Z)({pinKey:{type:"Legacy",data:M},orbacActingAs:N,viewer:ei}),eP=!!Object.keys(eC||{}).length,eS=ev?.did_it_data?.images_count??0,e_=(ev?.comment_count??0)+eS,ek=E||n?null:(0,_.jsx)(h.Z,{name:"CloseupActionBar_SecondarySendButton",children:(0,_.jsx)(B,{closeupWithinMasonryEnabled:V,controllerOptions:{flyoutDisplayOptions:V?{shownWithinProfileHeader:!0,idealDirection:"down",forceDirection:!0}:{wrapperPosition:"fixed"},isFlyoutOpen:er,loggingOptions:{component:194,element:72,viewParameter:L||en,viewType:z||et},onFlyoutDismiss:eg,onToggleFlyout:ex,sendObject:{type:"pin",description:t,id:M.id,imageUrl:q,ownerId:ey,url:`/pin/${M.id}/`,clientTrackingParams:X}},showSendAnimation:!0})}),eI=(0,_.jsx)(r.xu,{alignItems:"center",color:V?"transparent":"default","data-test-id":"closeup-action-items",display:"flex",justifyContent:"between",maxWidth:eb,rounding:2,children:(0,_.jsxs)(r.kC,{alignItems:"stretch",gap:2*!!V,justifyContent:"start",children:[!eo&&!!D&&(0,_.jsx)(h.Z,{name:"CloseupActionBar_ReactionPickerContainer",children:(0,_.jsxs)(r.xu,{alignItems:"center",display:"flex",marginEnd:2*!!eP,children:[(0,_.jsx)(T,{clientTrackingParams:X,handleReactionTrayHover:em,idealDirection:V?"down":void 0,pinId:M.id,reactionByMe:M.reaction_by_me,showTooltip:!0,viewParameter:L,viewType:z}),(0,_.jsx)(g.Z,{pinId:M.id,reactionCounts:eC,showPrettyNumber:!0})]})}),V&&!(i&&ef)&&(0,_.jsx)(Z,{inCommentsImprovedDropdownExp:!!i,inCommentsPopoverExp:!!S,isEligibleForAggregatedComments:!!A,pinKey:{type:"Legacy",data:M},scrollContainerRef:K,shouldShowCommentCount:!ef&&!!e_&&(!!S||!!i),totalCommentCount:e_,viewParameter:L,viewType:z}),ek,(0,_.jsx)(r.xu,{children:(0,_.jsx)(r.xu,{"data-test-id":"closeup-more-options",children:(0,_.jsx)(l.Z,{carouselSlotCurrentIndex:M&&M.carousel_data&&M.carousel_data.index,clientTrackingParams:X,closeupWithinMasonryEnabled:V,goBack:e,isReactionTrayOpen:el,onEditSubmit:R,pinKey:{type:"Legacy",data:M},showEditPin:!n&&ew,viewParameter:L,viewType:z})})})]})}),eB=V?void 0:G,eT=(0,_.jsxs)(r.xu,{ref:F,color:"default",dangerouslySetInlineStyle:{__style:{paddingTop:G/2,paddingRight:ej?void 0:eB,paddingLeft:ej?eB:void 0,paddingBottom:V?G/2:void 0,borderRadius:W?"0px 32px 32px 32px":Q?"0px 32px 32px 0":void 0}},"data-test-id":"closeup-body-sticky-content",marginTop:V?0:W?-5:0,width:V?"100%":void 0,children:[(0,_.jsx)(r.xu,{"data-test-id":"closeupActionBar",marginStart:ea?-3:void 0,children:(0,_.jsxs)(r.kC,{alignItems:"stretch",justifyContent:"between",children:[eI,(0,_.jsx)(r.kC,{alignItems:"center",gap:2,children:!n&&!eo&&(0,_.jsx)(r.xu,{marginStart:3*!V,children:(0,_.jsx)(k,{boardCount:ei.isAuth?ei.boardCount:0,clientTrackingParams:X,onClickCallback:O,pin:M,saveToBoardFromPostDownloadUpsell:eu,setSaveToBoardFromPostDownloadUpsell:eh,showEnabledSaveBehavior:$,showRepinOnInitialRender:U,variant:"closeup",viewParameter:L,viewType:z})})})]})}),(0,_.jsx)(I,{})]});if(H||V)return eT;let eZ=W&&!ee?w.cI+4:w.hu;return ee&&(eZ=0),(0,_.jsx)(r.Le,{top:eZ,zIndex:b.mS,children:eT})});function D(e){return(0,o.useEffect)(()=>{(0,i.Z)("CloseupActionBar","/app/common/react/components/closeup/CloseupActionBar/CloseupActionBar.tsx")},[]),(0,_.jsx)(A,{...e})}},595935:function(e,t,n){n.d(t,{Z:()=>x});var i=n(667294),o=n(20256),a=n(149739),r=n(521009),s=n(19585),l=n(709311),d=n(518459),c=n(355919),p=n(821806),u=n(785893);function h(e,t,n){var i;return(t="symbol"==typeof(i=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?i:i+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let m=(0,i.lazy)(()=>n.e("80948").then(n.bind(n,870828)));class g extends i.PureComponent{constructor(...e){super(...e),h(this,"state",{displayAggregationModal:!1}),h(this,"showAggregationModal",()=>{let{disableModal:e,logContextEvent:t}=this.props;e||(this.setState({displayAggregationModal:!0}),t({event_type:101,view_type:3,view_parameter:139,component:13458,element:11435,aux_data:{objectId:this.props.pinId}}))}),h(this,"hideAggregationModal",()=>{this.setState({displayAggregationModal:!1})})}render(){let{displayAggregationModal:e}=this.state,{isBold:t,isStoryPin:n,paddingY:i,pinId:r,reactionCounts:s,showPrettyNumber:h,size:g}=this.props,x=s?(0,c.At)(s):null,y=s?(0,c.Ud)(s):0,v=!!x&&x.length>0&&x.filter(e=>!!d.GY[e]).map((e,t)=>{let n=e&&d.GY[e]?d.GY[e]:"",{label:i,gridAsset:a}=(0,d.fW)(n,this.props.i18n);return(0,u.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{marginRight:2}},children:(0,u.jsx)(o.xu,{height:19,width:19,children:a&&(0,u.jsx)(o.Ee,{alt:i??"",fit:"cover",naturalHeight:1,naturalWidth:1,src:a})})},t)});return(0,u.jsxs)(o.xu,{children:[(0,u.jsx)(o.iP,{accessibilityLabel:`${y} reactions`,dataTestId:"reactions-count-button",onTap:this.showAggregationModal,children:!!v&&(0,u.jsx)(o.xu,{"data-test-id":"aggregated-reactions-container",display:"inlineBlock",children:h?(0,u.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{cursor:"pointer"}},children:(0,u.jsx)(o.xv,{size:g??a.n,weight:"bold",children:(0,u.jsx)(l.Z,{shortform:!0,shortformMaximumFractionDigits:1,value:y})})}):(0,u.jsxs)(o.xu,{alignItems:"center",dangerouslySetInlineStyle:{__style:{cursor:"pointer"}},"data-test-id":"aggregated-reactions-container",direction:"row",display:"flex",height:n?"auto":19,paddingY:i??6*!n,children:[(0,u.jsx)(o.kC,{alignItems:"stretch",direction:"row",justifyContent:"start",children:v}),(0,u.jsx)(o.xu,{paddingX:1,children:(0,u.jsx)(o.xv,{color:t?"default":"subtle",size:g??a.n,weight:t?"bold":"normal",children:(0,u.jsx)(l.Z,{shortform:!0,shortformMaximumFractionDigits:1,value:y})})})]})})}),e&&y&&(0,u.jsx)(p.Z,{children:(0,u.jsx)(m,{aggregatedReactions:v,onDismiss:this.hideAggregationModal,pinId:r,totalReactionCount:y})})]})}}h(g,"defaultProps",{isBold:!0});let x=function(e){let t=(0,s.ZP)(),n=(0,r.Z)();return(0,u.jsx)(g,{...e,i18n:t,logContextEvent:n})}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/CloseupActionBarCommon-b009b66b5e8bce76.mjs.map